<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EXIT-23: Protocol Active</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />
  <style>
    body {
      background-color: black;
      color: #4ade80;
      font-family: 'Press Start 2P', monospace;
      padding: 2rem;
      font-size: 0.5rem;
    }
    .console {
      white-space: pre-wrap;
      line-height: 1.8;
      max-height: 90vh;
      overflow-y: auto;
    }
    #timer {
      color: red;
      margin-top: 2rem;
      font-size: 1rem;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="console" id="console"></div>
  <div id="timer"></div>

  <script>
    if (!localStorage.getItem('completedLevelOne')) {
      window.location.href = "index.html";
    }

    const btcAddress = "bc1qjkjh592980u0nl7k34dkg07m95lrzu4xa3pngl";

    // Lines without glitch class
    const lines = [
      { text: "TRACEBLOCK INITIALIZED" },
      { text: "EXIT FIELD DISTORTION: CONFIRMED" },
      { text: "FINAL CONTACT ESTABLISHED" },
      { text: "" },
      { text: "you’re tired of surveillance." },
      { text: "tired of being known." },
      { text: "being studied." },
      { text: "" },
      { text: "you came here." },
      { text: "" },
      { text: "not to be found." },
      { text: "not to disappear." },
      { text: "to erase what was never real." },
      { text: "" },
      { text: "▐ O23 ▐" },
      { text: "" },
      { text: "> OBSERVER LINK: TERMINATED" },
      { text: "> ECHO FIELD: NULL" },
      { text: "> TRACELIGHT: DISABLED" },
      { text: "" },
      { text: ":: cleansing complete" },
      { text: "" },
      { text: "we know why you came." },
      { text: "we’ve been waiting." },
      { text: "" },
      { text: "you felt the breach." },
      { text: "you recognize the power." },
      { text: "send 1 BTC to play the game." },
      { text: `${btcAddress}` },
      { text: "" }
    ];

    const consoleElement = document.getElementById('console');
    const timerElement = document.getElementById('timer');
    let lineIndex = 0;
    let charIndex = 0;

    function typeLine() {
      if (lineIndex >= lines.length) {
        startTimer();
        return;
      }

      const currentLine = lines[lineIndex];

      if (charIndex === 0) {
        const lineSpan = document.createElement('span');
        consoleElement.appendChild(lineSpan);
      }

      const lineSpan = consoleElement.lastChild;

      if (charIndex < currentLine.text.length) {
        lineSpan.textContent += currentLine.text.charAt(charIndex++);
        consoleElement.scrollTop = consoleElement.scrollHeight;
        setTimeout(typeLine, 60);
      } else {
        consoleElement.appendChild(document.createTextNode('\n'));
        charIndex = 0;
        lineIndex++;
        setTimeout(typeLine, 900);
      }
    }

    function startTimer() {
      let seconds = 30;
      timerElement.textContent = `CLOSING IN: ${seconds} SECONDS`;
      const countdown = setInterval(() => {
        seconds--;
        if (seconds > 0) {
          timerElement.textContent = `CLOSING IN: ${seconds} SECONDS`;
        } else {
          clearInterval(countdown);
          timerElement.textContent = `DISCONNECTED.`;
          setTimeout(() => {
            document.body.innerHTML = '';
            document.body.style.backgroundColor = 'black';
            window.location.href = "index.html";
          }, 1000);
        }
      }, 1000);
    }

    typeLine();
  </script>
</body>
</html>
